---
title: "EDA"
authors:
- Kevin Sheng
- Arushi Agarwal
- Peter Kim
- Nathan Dang
output: html_notebook
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, cache = T, fig.width=6, fig.height=3)
options(scipen = 0, digits = 3)  # controls base R output
if(!require('pacman')) {
  install.packages('pacman')
}
pacman::p_load( glmnet, leaps, car, tidyverse, pROC, caret, dplyr, ggplot)
# install a package if it does not exist already and put the package in the path (library)
# dplyr, ggplot2,tidyr
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
library (readr)

urlfile="https://raw.githubusercontent.com/SansPapyrus683/ed-success/main/data/final_data.csv"

data_2017<-read_csv(url(urlfile))

summary(data_2017)
```

## Including Plots

You can also embed plots, for example:

let's start off with some rudimentary stuff
```{r rudimentary stuff}
data_2017 %>%
    select(-c("fips", "fips_state", "fips_county")) %>%
    summary()
```

# start with population

for some weird reason population isn't a normal distribution
```{r}
data_2017 %>% ggplot() + geom_histogram(aes(x = pop), bins = 10)
```

even if you just break down the first bar, it isn't really normal. The plot is skewed-right and shows us that the majority of counties in the US have a population between ~5k and 100k.
```{r}
# to prevent the super big counties from making the rest really darn small
pop_lim <- 2e5
lim_data <- data_2017 %>% filter(pop < pop_lim)
lim_data %>% ggplot() + geom_histogram(aes(x = pop), bins = 100)
```

We first explored the question of "how does the high school graduation percentage of a county correlate to its income per capita?"
```{r, fig.width=6, fig.height=3}
data_2017 %>%
  ggplot(aes(x=hs_grad, y=per_capita_income)) + 
  geom_jitter(height = .05, aes(color = per_capita_income))
```
From the plot, it could be seen that there is a srong positive, somewhat exponential, correlation between hs_grad and per_capita_income. As hs_grad increase, per_capita_income also increase.


let's try plotting population against some stats, maybe larger cities have some common characteristics
```{r}
points <- c("property crime", "violent crime")
lim_data %>%
    ggplot(aes(x = pop)) +
    geom_jitter(aes(y = property_crime_rate, colour = points[1])) +
    geom_jitter(aes(y = violent_crime_rate, colour = points[2])) +
    scale_color_manual("type", breaks = points, values = c("blue", "red")) +
    xlab("population") +
    ylab("crime per 100k people") +
    labs(title = "crime rates vs. population")
points <- c("unemployment rate", "poverty rate")
lim_data %>%
    ggplot(aes(x = pop)) +
    geom_jitter(aes(y = unemployment_rate, colour = points[1])) +
    geom_jitter(aes(y = poverty, colour = points[2])) +
    scale_color_manual("type", breaks = points, values = c("purple", "red")) +
    xlab("population") +
    ylab("percentage") +
    labs(title = "percentage stuff vs. population")
points <- c("median household income", "per capita income")
lim_data %>%
    ggplot(aes(x = pop)) +
    geom_jitter(aes(y = median_household_income, colour = points[1])) +
    geom_jitter(aes(y = per_capita_income, colour = points[2])) +
    scale_color_manual("type", breaks = points, values = c("green", "yellow")) +
    xlab("population") +
    ylab("income ($)") +
    labs(title = "income vs. population")
```
oh...kay... those weren't really the results i was hoping for

by the way if you see that one county that has a property crime rate of 5k per 100k people, it's bibb county in georgia \

ok now let's plot some stuff against `hs_grad`, maybe that'll yield better results
```{r}
points <- c("property crime", "violent crime")
lim_data %>%
    ggplot(aes(x = hs_grad)) +
    geom_jitter(aes(y = property_crime_rate, colour = points[1])) +
    geom_jitter(aes(y = violent_crime_rate, colour = points[2])) +
    scale_color_manual("type", breaks = points, values = c("blue", "red")) +
    xlab("high school grad rate") +
    ylab("crime per 100k people") +
    labs(title = "crime rates vs. high school grad rate")
points <- c("unemployment rate", "poverty rate")
lim_data %>%
    ggplot(aes(x = hs_grad)) +
    geom_jitter(aes(y = unemployment_rate, colour = points[1])) +
    geom_jitter(aes(y = poverty, colour = points[2])) +
    scale_color_manual("type", breaks = points, values = c("purple", "red")) +
    xlab("high school grad rate") +
    ylab("percentage") +
    labs(title = "percentage stuff vs. high school grad rate")
points <- c("median household income", "per capita income")
lim_data %>%
    ggplot(aes(x = hs_grad)) +
    geom_jitter(aes(y = median_household_income, colour = points[1])) +
    geom_jitter(aes(y = per_capita_income, colour = points[2])) +
    scale_color_manual("type", breaks = points, values = c("green", "yellow")) +
    xlab("high school grad rate") +
    ylab("income ($)") +
    labs(title = "income vs. high school grad rate")
```
wow that's so much better \
maybe our idea wasn't absolute dogwater. We note ,though, how high school grad rate has a clear correlation to poverty rate (where poverty rate decreases as high school grad rate increases) but doesn't affect unemployment rate nearly as strong. This leads us to question how does poverty rate and unemployment rate relate to one another. Also, seeing how hs_grad somewhat correlates with property crime but not with violent crime, we are curious to see whether the crime rates themselves correlate to one another.

```{r, fig.width=6, fig.height=3}
data_2017 %>%
  ggplot(aes(x=unemployment_rate, y=poverty)) + 
  geom_jitter(height = .05, aes(color = poverty))
```
There seems to be a strong positive linear trend between unemployment rate and poverty rate; hs_grad rate might just not affect unemployment rate that strongly.

```{r, fig.width=6, fig.height=3}
data_2017 %>%
  ggplot(aes(x=property_crime_rate, y=violent_crime_rate)) + 
  geom_jitter(height = .05, aes(color = violent_crime_rate))
```
There appears to be a positive and somewhat linear correlation between property crime rate and violent crime rate. We're interested to dig in more about this and find out exactly why this is the case.
also tried graphing `broadband` and `computer` against `median_household_income` and got this:
```{r}
points <- c("broadband access", "computer access %")
lim_data %>%
    ggplot(aes(x = median_household_income)) +
    geom_jitter(aes(y = broadband, colour = points[1])) +
    geom_jitter(aes(y = computer, colour = points[2])) +
    scale_color_manual("type", breaks = points, values = c("cyan", "blue")) +
    xlab("median household income") +
    ylab("% of pop") +
    labs(title = "tech access measures vs. median household income")
```
a very positive correlation, but it's painfully obvious when you realize that richer families will *obviously* have more purchasing power for tech products and stuff \
so yeah, we're taking that away from the predictors because it's cheating, in a sense
Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
